<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saahithi Space</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --neural-primary: #9b59b6;
            --neural-secondary: #e74c3c;
            --neural-tertiary: #f39c12;
            --dark: #0a0e27;
            --darker: #050817;
            --text-primary: #e8eaed;
            --text-secondary: #9ca3af;
            --card-bg: rgba(255, 255, 255, 0.08);
            --card-border: rgba(255, 255, 255, 0.12);
        }

        body.light-mode {
            --neural-primary: #9b59b6;
            --neural-secondary: #e74c3c;
            --neural-tertiary: #f39c12;
            --dark: #fafafa;
            --darker: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #6c757d;
            --card-bg: rgba(255, 255, 255, 0.9);
            --card-border: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Lexend', sans-serif;
            background: var(--darker);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Neural Network Canvas */
        #neuralCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.4;
        }

        #neuralCanvas.active {
            opacity: 0.7;
            transition: opacity 0.6s ease;
        }

        /* Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem 0 3rem;
            flex-wrap: wrap;
            gap: 2rem;
        }

        .logo-area {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 0 40px rgba(0, 212, 255, 0.3);
            animation: pulse-glow 3s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 40px rgba(155, 89, 182, 0.3); }
            50% { box-shadow: 0 0 60px rgba(155, 89, 182, 0.5); }
        }

        .title {
            font-size: 1.5rem;
            font-weight: 300;
            letter-spacing: -0.02em;
        }

        .title span {
            font-weight: 600;
            background: linear-gradient(135deg, var(--neural-primary), var(--neural-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(20px);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(155, 89, 182, 0.3);
            border-color: var(--neural-primary);
        }

        .theme-toggle svg {
            width: 24px;
            height: 24px;
            fill: var(--text-primary);
            transition: all 0.4s ease;
        }

        .theme-toggle .sun-icon {
            fill: none;
            stroke: var(--text-primary);
            stroke-width: 2;
            stroke-linecap: round;
        }

        .theme-toggle .sun-icon {
            opacity: 0;
            position: absolute;
        }

        .theme-toggle .moon-icon {
            opacity: 1;
        }

        body.light-mode .theme-toggle .sun-icon {
            opacity: 1;
        }

        body.light-mode .theme-toggle .moon-icon {
            opacity: 0;
        }

        body.light-mode {
            background: var(--darker);
        }

        /* Modal / Expanded Card View */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        body.light-mode .modal-overlay {
            background: rgba(255, 255, 255, 0.95);
        }

        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 3rem;
            position: relative;
            transform: scale(0.9) translateY(20px);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-overlay.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(155, 89, 182, 0.2);
            border-color: var(--neural-primary);
            transform: rotate(90deg);
        }

        .modal-close::before,
        .modal-close::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 2px;
            background: var(--text-primary);
        }

        .modal-close::before {
            transform: rotate(45deg);
        }

        .modal-close::after {
            transform: rotate(-45deg);
        }

        .modal-header {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--card-border);
        }

        .modal-date {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--neural-primary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
        }

        .modal-title {
            font-size: 2.5rem;
            font-weight: 500;
            line-height: 1.2;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, var(--neural-primary), var(--neural-secondary), var(--neural-tertiary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .modal-body {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .modal-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .modal-tag {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--neural-primary);
            background: rgba(155, 89, 182, 0.15);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            border: 1px solid rgba(155, 89, 182, 0.3);
        }

        .modal-tag.secondary {
            color: var(--neural-secondary);
            background: rgba(231, 76, 60, 0.15);
            border-color: rgba(231, 76, 60, 0.3);
        }

        @media (max-width: 768px) {
            .modal-content {
                padding: 2rem;
                max-height: 95vh;
            }

            .modal-title {
                font-size: 2rem;
            }

            .modal-body {
                font-size: 1rem;
            }
        }

        /* Navigation */
        .nav-container {
            display: flex;
            gap: 0.5rem;
            background: var(--card-bg);
            padding: 0.5rem;
            border-radius: 50px;
            border: 1px solid var(--card-border);
            backdrop-filter: blur(20px);
        }

        .nav-tab {
            padding: 0.75rem 1.75rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 400;
            color: var(--text-secondary);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            font-family: 'JetBrains Mono', monospace;
            text-transform: lowercase;
        }

        .nav-tab:hover {
            color: var(--text-primary);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, rgba(155, 89, 182, 0.2), rgba(231, 76, 60, 0.2));
            color: var(--text-primary);
            font-weight: 500;
            box-shadow: 0 4px 20px rgba(155, 89, 182, 0.3);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Hero */
        .hero {
            text-align: center;
            margin: 3rem auto 4rem;
            max-width: 800px;
        }

        .hero h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 300;
            margin-bottom: 1rem;
            letter-spacing: -0.03em;
            line-height: 1.2;
        }

        .hero .gradient {
            font-weight: 600;
            background: linear-gradient(135deg, var(--neural-primary), var(--neural-secondary), var(--neural-tertiary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 300;
            line-height: 1.7;
        }

        /* Grid */
        .masonry-grid {
            column-count: 3;
            column-gap: 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        @media (max-width: 1024px) {
            .masonry-grid { column-count: 2; }
        }

        @media (max-width: 640px) {
            .masonry-grid { column-count: 1; }
            #neuralCanvas { opacity: 0.2; }
        }

        /* Cards */
        .card {
            break-inside: avoid;
            margin-bottom: 1.5rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 2rem;
            cursor: pointer;
            position: relative;
            backdrop-filter: blur(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 1;
            animation: slideUp 0.6s ease forwards;
        }

        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
        }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card::before {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: 16px;
            padding: 1px;
            background: linear-gradient(135deg, transparent, transparent);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            border-color: rgba(155, 89, 182, 0.3);
            box-shadow: 0 8px 40px rgba(155, 89, 182, 0.15);
        }

        .card:hover::before {
            opacity: 1;
            background: linear-gradient(135deg, var(--neural-primary), var(--neural-secondary));
        }

        .card.highlighted {
            border-color: var(--neural-primary);
            box-shadow: 0 0 40px rgba(155, 89, 182, 0.4);
            background: rgba(155, 89, 182, 0.05);
        }

        .card.highlighted::before {
            opacity: 1;
            background: linear-gradient(135deg, var(--neural-primary), var(--neural-secondary), var(--neural-tertiary));
        }

        /* Card Content */
        .card-date {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--neural-primary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.75rem;
            opacity: 0.8;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 500;
            margin-bottom: 1rem;
            line-height: 1.3;
            color: var(--text-primary);
        }

        .card-excerpt {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.7;
            font-weight: 300;
        }

        .card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1.25rem;
        }

        .card-tag {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--neural-primary);
            background: rgba(155, 89, 182, 0.1);
            padding: 0.35rem 0.75rem;
            border-radius: 20px;
            border: 1px solid rgba(155, 89, 182, 0.2);
        }

        .card-tag.secondary {
            color: var(--neural-secondary);
            background: rgba(231, 76, 60, 0.1);
            border-color: rgba(231, 76, 60, 0.2);
        }

        /* Category-specific styling */
        .card[data-category="frontburner"] .card-date {
            color: var(--neural-secondary);
        }

        .card[data-category="backburner"] .card-date {
            color: var(--neural-tertiary);
        }

        .card[data-category="cold-storage"] .card-date {
            color: var(--neural-primary);
        }

        .card[data-category="questions"] .card-date {
            color: #c77dff;
        }

        /* Handle variable text length - Truncate to 4 lines */
        .card-excerpt {
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Modal text should show everything */
        .modal-body {
            white-space: pre-wrap; /* Preserves paragraphs for long-form content */
            max-width: 650px;
            margin: 0 auto 2rem;
        }
        
        /* CTA Footer */
        .cta-section {
            margin-top: 8rem;
            padding: 4rem 2rem;
            text-align: center;
            border-top: 1px solid var(--card-border);
            background: linear-gradient(to bottom, transparent, rgba(155, 89, 182, 0.05));
        }
        
        .cta-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .cta-btn {
            padding: 0.8rem 2rem;
            border-radius: 50px;
            text-decoration: none;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border: 1px solid var(--neural-primary);
        }
        
        .cta-btn.primary {
            background: var(--neural-primary);
            color: white;
        }
        
        .cta-btn.secondary {
            color: var(--text-primary);
        }
        
        .cta-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(155, 89, 182, 0.2);
        }
        
        /* Tag Active State */
        .card-tag.active-filter {
            background: var(--neural-primary);
            color: white;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1.5rem;
            }

            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1.5rem;
            }

            .avatar {
                width: 100px;
                height: 100px;
            }

            .nav-container {
                width: 100%;
                overflow-x: auto;
                justify-content: flex-start;
            }

            .nav-tab {
                white-space: nowrap;
            }

            .hero {
                margin: 2rem auto 3rem;
            }
        }
    </style>
</head>
<body>
    <canvas id="neuralCanvas"></canvas>

    <!-- Theme Toggle -->
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
        <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
        <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="1" x2="12" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="23"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
            <line x1="1" y1="12" x2="3" y2="12"/>
            <line x1="21" y1="12" x2="23" y2="12"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
    </button>

    <!-- Modal for Expanded Card View -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content">
            <button class="modal-close" id="modalClose" aria-label="Close"></button>
            <div class="modal-header">
                <div class="modal-date" id="modalDate"></div>
                <h2 class="modal-title" id="modalTitle"></h2>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-tags" id="modalTags"></div>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo-area">
                <img src="avatar.png" alt="Avatar" class="avatar">
                <h1 class="title">saahithi<span>space</span></h1>
            </div>
            <nav class="nav-container">
                <div class="nav-tab active" data-tab="frontburner">frontburner</div>
                <div class="nav-tab" data-tab="backburner">backburner</div>
                <div class="nav-tab" data-tab="cold-storage">cold storage</div>
                <div class="nav-tab" data-tab="questions">questions</div>
            </nav>
        </header>

        <!-- Frontburner Tab -->
        <div class="tab-content active" data-tab-content="frontburner">
            <div class="hero">
                <h1><span class="gradient">Active explorations</span></h1>
                <p>What's consuming high heat right now.</p>
            </div>
            <div class="masonry-grid" id="frontburnerGrid"></div>
        </div>

        <!-- Backburner Tab -->
        <div class="tab-content" data-tab-content="backburner">
            <div class="hero">
                <h1><span class="gradient">Simmering lessons</span></h1>
                <p>Low heat, steady progress.</p>
            </div>
            <div class="masonry-grid" id="backburnerGrid"></div>
        </div>

        <!-- Cold Storage Tab -->
        <div class="tab-content" data-tab-content="cold-storage">
            <div class="hero">
                <h1><span class="gradient">Preserved ideas</span></h1>
                <p>Frozen to memory.</p>
            </div>
            <div class="masonry-grid" id="coldStorageGrid"></div>
        </div>

        <!-- Questions Tab -->
        <div class="tab-content" data-tab-content="questions">
            <div class="hero">
                <h1><span class="gradient">Open questions</span></h1>
                <p>Conversation starters.</p>
            </div>
            <div class="masonry-grid" id="questionsGrid"></div>
        </div>
        
        <!-- CTA -->
        <footer class="cta-section">
            <h3>Interested in these spaces?</h3>
            <p>I'm always open to discussing AI, strategy, or the future of learning.</p>
            <div class="cta-links">
                <a href="mailto:saahithi.budharaju@kellogg.northwestern.edu" class="cta-btn primary">Email Me</a>
                <a href="https://linkedin.com/in/sbudharaju" target="_blank" class="cta-btn secondary">LinkedIn</a>
            </div>
        </footer>
    </div>

    <script>
        // ============================================
        // CONTENT DATA - EDIT THIS TO ADD NEW CARDS
        // ============================================
        //
        // Add items to any category:
        // - frontburner: Active, high-priority work
        // - backburner: Background projects
        // - coldStorage: Saved for later
        // - questions: Open inquiries
        //
        // Each item needs:
        // {
        //     date: 'Jan 2025',
        //     title: 'Card Title',
        //     excerpt: 'Description...',
        //     tags: ['tag1', 'tag2']  // optional
        // }
        // ============================================

        const CONTENT = {
            frontburner: [
                {
                    date: 'Jan 2025',
                    title: 'Building This Website',
                    excerpt: 'Creating a clean, modular system for organizing thoughts. The neural network metaphor helps visualize how ideas connect.',
                    tags: ['web', 'design']
                },
                {
                    date: 'Jan 2025',
                    title: 'Model Context Protocol',
                    excerpt: 'Learning how to let AI tools work directly with my data. Breaking down the complexity of connecting Claude to different platforms.',
                    tags: ['ai', 'integration']
                },
                {
                    date: 'Dec 2024',
                    title: 'MBA First Quarter',
                    excerpt: 'Navigating new frameworks for strategy, operations, and leadership. The challenge isn\'t the concepts—it\'s applying them fast enough.',
                    tags: ['learning', 'kellogg']
                }
            ],

            backburner: [
                {
                    date: 'Nov 2024',
                    title: 'Personal Knowledge System',
                    excerpt: 'Designing a better way to capture and connect ideas over time. Not just notes—but a web of thinking that grows smarter.',
                    tags: ['systems', 'learning']
                },
                {
                    date: 'Oct 2024',
                    title: 'AI Mentorship at Scale',
                    excerpt: 'What if AI could help scale 1:1 mentorship? Not replace it, but amplify it. Creating personalized guidance for 100+ people.',
                    tags: ['ai', 'mentorship']
                },
                {
                    date: 'Sep 2024',
                    title: 'Consulting → Product Transition',
                    excerpt: 'Learning to build for myself instead of clients. The mindset shift from project-based to product-based thinking.',
                    tags: ['career', 'product']
                }
            ],

            coldStorage: [
                {
                    date: 'Aug 2024',
                    title: 'Startup Idea: AI Learning Companion',
                    excerpt: 'An AI that learns your goals and nudges you toward growth. Not a task manager—a thinking partner. Shelved for now, but the core idea still resonates.',
                    tags: ['startup', 'ai']
                },
                {
                    date: 'Jul 2024',
                    title: 'Workshop Frameworks from Deloitte',
                    excerpt: 'Facilitation patterns that worked with 1100+ practitioners. Could be a book, a course, or just internal knowledge. Worth preserving.',
                    tags: ['facilitation', 'frameworks']
                },
                {
                    date: 'Jun 2024',
                    title: 'Cognitive Science Research',
                    excerpt: 'My undergrad work on memory and learning. The foundations still inform how I think about AI and education today.',
                    tags: ['research', 'cogsci']
                }
            ],

            questions: [
                {
                    date: '',
                    title: 'How do you measure growth that isn\'t quantifiable?',
                    excerpt: 'Becoming a better mentor, thinker, or person doesn\'t show up in metrics. How do you know you\'re improving?',
                    tags: ['growth', 'measurement']
                },
                {
                    date: '',
                    title: 'What\'s the right balance between depth and breadth?',
                    excerpt: 'Specialization gets you hired. Range makes you adaptable. When do you commit to one path vs. staying generalist?',
                    tags: ['career', 'learning']
                },
                {
                    date: '',
                    title: 'Can AI truly augment human creativity?',
                    excerpt: 'Or does it just make us faster at being average? The tools are incredible, but are they making us better or just more productive?',
                    tags: ['ai', 'creativity']
                },
                {
                    date: '',
                    title: 'What makes a good life?',
                    excerpt: 'Achievement? Connection? Impact? Learning? All of the above? None? Still figuring this one out.',
                    tags: ['philosophy', 'life']
                }
            ]
        };

        // ============================================
        // APPLICATION STATE
        // ============================================

        let canvas, ctx;
        let particles = [];
        let currentTab = 'frontburner';
        let activeCardPosition = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
            }
            
            initializeCanvas();
            renderAllContent();
            setupEventListeners();
            startAnimation();
        });

        // ============================================
        // CANVAS & NEURAL NETWORK
        // ============================================

        function initializeCanvas() {
            canvas = document.getElementById('neuralCanvas');
            ctx = canvas.getContext('2d');
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);

            const particleCount = window.innerWidth < 768 ? 50 : 120;
            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    vx: (Math.random() - 0.5) * 0.4,
                    vy: (Math.random() - 0.5) * 0.4,
                    radius: Math.random() * 1.5 + 1.5
                });
            }
        }

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = document.documentElement.scrollHeight;
        }

        function startAnimation() {
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Update particles
                particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;

                    if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
                    if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
                });

                // Draw connections
                for (let i = 0; i < particles.length; i++) {
                    for (let j = i + 1; j < particles.length; j++) {
                        const dx = particles[i].x - particles[j].x;
                        const dy = particles[i].y - particles[j].y;
                        const distance = Math.sqrt(dx * dx + dy * dy);

                        if (distance < 150) {
                            let opacity = (1 - distance / 150) * 0.3;

                            // Brighten near active card
                            if (activeCardPosition) {
                                const midX = (particles[i].x + particles[j].x) / 2;
                                const midY = (particles[i].y + particles[j].y) / 2;
                                const dxActive = midX - activeCardPosition.x;
                                const dyActive = midY - activeCardPosition.y;
                                const distToActive = Math.sqrt(dxActive * dxActive + dyActive * dyActive);

                                if (distToActive < 300) {
                                    const brightnessFactor = 1 - distToActive / 300;
                                    opacity = opacity + brightnessFactor * 0.6;
                                }
                            }

                            const gradient = ctx.createLinearGradient(
                                particles[i].x, particles[i].y,
                                particles[j].x, particles[j].y
                            );
                            gradient.addColorStop(0, `rgba(155, 89, 182, ${opacity})`);
                            gradient.addColorStop(0.5, `rgba(231, 76, 60, ${opacity})`);
                            gradient.addColorStop(1, `rgba(243, 156, 18, ${opacity})`);

                            ctx.strokeStyle = gradient;
                            ctx.lineWidth = 1;
                            ctx.beginPath();
                            ctx.moveTo(particles[i].x, particles[i].y);
                            ctx.lineTo(particles[j].x, particles[j].y);
                            ctx.stroke();
                        }
                    }
                }

                // Draw particles
                particles.forEach(p => {
                    let particleOpacity = 0.5;
                    let particleSize = p.radius;

                    if (activeCardPosition) {
                        const dx = p.x - activeCardPosition.x;
                        const dy = p.y - activeCardPosition.y;
                        const distToActive = Math.sqrt(dx * dx + dy * dy);
                        if (distToActive < 300) {
                            const brightnessFactor = 1 - distToActive / 300;
                            particleOpacity = 0.5 + brightnessFactor * 0.5;
                            particleSize = p.radius * (1 + brightnessFactor * 0.8);
                        }
                    }

                    const gradient = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, particleSize);
                    gradient.addColorStop(0, `rgba(155, 89, 182, ${particleOpacity})`);
                    gradient.addColorStop(1, `rgba(155, 89, 182, 0)`);

                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, particleSize, 0, Math.PI * 2);
                    ctx.fill();
                });

                requestAnimationFrame(animate);
            }
            animate();
        }

        // ============================================
        // CONTENT RENDERING
        // ============================================

        // Add this to your APPLICATION STATE
        let activeFilter = null;
        
        function renderGrid(contentKey, category, gridId) {
            const actualGridId = gridId || `${contentKey}Grid`;
            const grid = document.getElementById(actualGridId);
            if (!grid) return;
            
            grid.innerHTML = '';
        
            // Filter content based on active tag
            const filteredContent = activeFilter 
                ? CONTENT[contentKey].filter(item => item.tags && item.tags.includes(activeFilter))
                : CONTENT[contentKey];
        
            filteredContent.forEach((item, index) => {
                const card = createCard(item, category, index);
                grid.appendChild(card);
            });
        }
        
        function createCard(data, category, index) {
            const card = document.createElement('div');
            card.className = 'card';
            card.dataset.category = category;
            
            // UI logic for tags
            const tagsHTML = data.tags 
                ? `<div class="card-tags">
                     ${data.tags.map(tag => {
                        const isActive = tag === activeFilter ? 'active-filter' : '';
                        return `<span class="card-tag ${isActive}" onclick="event.stopPropagation(); toggleFilter('${tag}')">${tag}</span>`;
                     }).join('')}
                   </div>`
                : '';
        
            card.innerHTML = `
                ${data.date ? `<div class="card-date">${data.date}</div>` : ''}
                <div class="card-title">${data.title}</div>
                <div class="card-excerpt">${data.excerpt}</div>
                ${tagsHTML}
            `;
        
            card.addEventListener('click', () => openCardModal(card, data));
            return card;
        }
        
        function toggleFilter(tag) {
            activeFilter = (activeFilter === tag) ? null : tag;
            renderAllContent();
        }
        
        // Ensure resize happens on tab switch to fix canvas height
        function switchTab(tab) {
            currentTab = tab;
            clearHighlights();
            
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-tab-content="${tab}"]`).classList.add('active');
        
            resizeCanvas(); // Important for background stretch
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ============================================
        // MODAL / EXPANDED CARD VIEW
        // ============================================

        function openCardModal(card, data) {
            const modal = document.getElementById('modalOverlay');
            const modalDate = document.getElementById('modalDate');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const modalTags = document.getElementById('modalTags');

            // Populate modal
            modalDate.textContent = data.date || '';
            modalDate.style.display = data.date ? 'block' : 'none';
            modalTitle.textContent = data.title;
            modalBody.textContent = data.excerpt;

            // Populate tags
            if (data.tags && data.tags.length > 0) {
                modalTags.innerHTML = data.tags.map((tag, i) => 
                    `<span class="modal-tag ${i % 2 === 1 ? 'secondary' : ''}">${tag}</span>`
                ).join('');
                modalTags.style.display = 'flex';
            } else {
                modalTags.style.display = 'none';
            }

            // Activate neural network around card
            highlightCard(card);

            // Show modal
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';

            // Update URL (optional - for sharing)
            const cardId = data.title.toLowerCase().replace(/[^a-z0-9]+/g, '-');
            history.pushState({ cardId }, '', `#${cardId}`);
        }

        function closeCardModal() {
            const modal = document.getElementById('modalOverlay');
            modal.classList.remove('active');
            document.body.style.overflow = '';
            clearHighlights();

            // Reset URL
            history.pushState({}, '', window.location.pathname);
        }

        // ============================================
        // INTERACTION
        // ============================================

        function highlightCard(card) {
            clearHighlights();
            card.classList.add('highlighted');
            canvas.classList.add('active');

            const rect = card.getBoundingClientRect();
            activeCardPosition = {
                x: rect.left + rect.width / 2,
                y: rect.top + rect.height / 2 + window.scrollY
            };
        }

        function clearHighlights() {
            document.querySelectorAll('.card').forEach(c => c.classList.remove('highlighted'));
            canvas.classList.remove('active');
            activeCardPosition = null;
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================

        function setupEventListeners() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });

            document.getElementById('themeToggle').addEventListener('click', toggleTheme);

            // Modal close handlers
            document.getElementById('modalClose').addEventListener('click', (e) => {
                e.stopPropagation();
                closeCardModal();
            });

            document.getElementById('modalOverlay').addEventListener('click', (e) => {
                if (e.target.id === 'modalOverlay') {
                    closeCardModal();
                }
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeCardModal();
                }
            });

            // Handle browser back button
            window.addEventListener('popstate', (e) => {
                closeCardModal();
            });

            document.addEventListener('click', (e) => {
                if (!e.target.closest('.card') && !e.target.closest('.modal-content')) {
                    clearHighlights();
                }
            });
        }

        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const isLight = document.body.classList.contains('light-mode');
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
        }

        function switchTab(tab) {
            currentTab = tab;
            clearHighlights();

            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-tab="${tab}"]`).classList.add('active');

            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-tab-content="${tab}"]`).classList.add('active');

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
